<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<meta name="theme-color" content="#222">
<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>


  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Math,Course,Java,">





  <link rel="alternate" href="/atom.xml" title="不断努力的Koo" type="application/atom+xml">






<meta name="description" content="计算方法部分方法代码实现Java实现">
<meta name="keywords" content="Math,Course,Java">
<meta property="og:type" content="article">
<meta property="og:title" content="计算方法上机代码">
<meta property="og:url" content="http://yoursite.com/2019/12/28/ComputationlMethodsCode/index.html">
<meta property="og:site_name" content="不断努力的Koo">
<meta property="og:description" content="计算方法部分方法代码实现Java实现">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-08-05T11:37:57.579Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="计算方法上机代码">
<meta name="twitter:description" content="计算方法部分方法代码实现Java实现">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/12/28/ComputationlMethodsCode/">





  <title>计算方法上机代码 | 不断努力的Koo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/Blanknesses" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">不断努力的Koo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">为了心爱的Nozomi</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>
            
            日程表
          </a>
        </li>
      
        
        <li class="menu-item menu-item-playlist">
          <a href="/playlist/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-music"></i> <br>
            
            歌单
          </a>
        </li>
      
        
        <li class="menu-item menu-item-target">
          <a href="/target/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar-check-o"></i> <br>
            
            目标
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/28/ComputationlMethodsCode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Koo">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不断努力的Koo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">计算方法上机代码</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-28T12:11:30+08:00">
                2019-12-28
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Course/" itemprop="url" rel="index">
                    <span itemprop="name">Course</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7.3k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  38
                </span>
              
            </div>
          

          
              <div class="post-description">
                  <center>计算方法部分方法代码实现<br>Java实现</center>
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="1-4-向量范数计算"><a href="#1-4-向量范数计算" class="headerlink" title="1.4 向量范数计算"></a>1.4 向量范数计算</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.abs;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.sqrt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VectorNorm</span> </span>&#123;</span><br><span class="line">    <span class="comment">//向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] vector;</span><br><span class="line">    <span class="comment">//向量长度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向量构造函数1</span></span><br><span class="line"><span class="comment">     * 构造成1,1/2,...,1/n的向量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n 向量长度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generateVector1</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        vector = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            vector[i - <span class="number">1</span>] = <span class="number">1</span>/(<span class="keyword">double</span>)i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向量构造函数2</span></span><br><span class="line"><span class="comment">     * 构造成1,2,...,n的向量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n 向量长度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generateVector2</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        vector = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            vector[i - <span class="number">1</span>] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造函数，调用向量构造函数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n 向量长度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VectorNorm</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        N = n;</span><br><span class="line">        <span class="comment">//generateVector1(n);</span></span><br><span class="line">        generateVector2(n);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向量1-范数计算</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 向量元素和</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">norm1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            result = result + vector[i];</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向量2-范数计算</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 向量元素平方和开方</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">norm2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            result = result + vector[i] * vector[i];</span><br><span class="line">        <span class="keyword">return</span> sqrt(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向量无穷范数计算</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 向量最大元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">normInfty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> max = vector[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i ++)</span><br><span class="line">            <span class="keyword">if</span>(vector[i] &gt; max)</span><br><span class="line">                max = vector[i];</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">double</span>[] getVector() &#123;</span><br><span class="line">        <span class="keyword">return</span> vector;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><table>
<thead>
<tr>
<th align="center">$n$</th>
<th align="center">$\Vert (1,\dfrac{1}{2},\cdots,\dfrac{1}{n})^T\Vert_1$</th>
<th align="center">$\Vert (1,\dfrac{1}{2},\cdots,\dfrac{1}{n})^T\Vert_2$</th>
<th align="center">$\Vert (1,\dfrac{1}{2},\cdots,\dfrac{1}{n})^T\Vert_\infty$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$10 $</td>
<td align="center">$2.928968$</td>
<td align="center">$1.244897$</td>
<td align="center">$1.000000$</td>
</tr>
<tr>
<td align="center">$100 $</td>
<td align="center">$5.187378$</td>
<td align="center">$1.278665$</td>
<td align="center">$1.000000$</td>
</tr>
<tr>
<td align="center">$1000 $</td>
<td align="center">$7.485471$</td>
<td align="center">$1.282160$</td>
<td align="center">$1.000000$</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">$n$</th>
<th align="center">$\Vert (1,2,\cdots,n)^T\Vert_1$</th>
<th align="center">$\Vert(1,2,\cdots,n)^T\Vert_2$</th>
<th align="center">$\Vert(1,2,\cdots,n)^T\Vert_\infty$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$ 10 $</td>
<td align="center">$55$</td>
<td align="center">$19.621417$</td>
<td align="center">$10$</td>
</tr>
<tr>
<td align="center">$ 100 $</td>
<td align="center">$5050$</td>
<td align="center">$581.678605$</td>
<td align="center">$100$</td>
</tr>
<tr>
<td align="center">$ 1000 $</td>
<td align="center">$500500$</td>
<td align="center">$18271.111077$</td>
<td align="center">$1000$</td>
</tr>
</tbody></table>
<h2 id="2-1-高斯列主元"><a href="#2-1-高斯列主元" class="headerlink" title="2.1 高斯列主元"></a>2.1 高斯列主元</h2><p>$PA=LU$存在部分问题，$L$阵求法有问题<br>$Doolittle$分解，求行列式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.abs;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EMCP</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义行列</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> Row = <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> Column = <span class="number">9</span>;</span><br><span class="line">    <span class="comment">//定义两个解向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] result_x = <span class="keyword">new</span> <span class="keyword">double</span>[Column];</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] result_y = <span class="keyword">new</span> <span class="keyword">double</span>[Column];</span><br><span class="line">    <span class="comment">//列主元LU分解，置换矩阵P</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] P;</span><br><span class="line">    <span class="comment">//系数矩阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] Matrix = &#123;</span><br><span class="line">            &#123;<span class="number">31</span>,-<span class="number">13</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">10</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">            &#123;-<span class="number">13</span>,<span class="number">35</span>,-<span class="number">9</span>,<span class="number">0</span>,-<span class="number">11</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">            &#123;<span class="number">0</span>,-<span class="number">9</span>,<span class="number">31</span>,-<span class="number">10</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">            &#123;<span class="number">0</span>,<span class="number">0</span>,-<span class="number">10</span>,<span class="number">79</span>,-<span class="number">30</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">9</span>&#125;,</span><br><span class="line">            &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">30</span>,<span class="number">57</span>,-<span class="number">7</span>,<span class="number">0</span>,-<span class="number">5</span>,<span class="number">0</span>&#125;,</span><br><span class="line">            &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">7</span>,<span class="number">47</span>,-<span class="number">30</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">            &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">30</span>,<span class="number">41</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">            &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">27</span>,-<span class="number">2</span>&#125;,</span><br><span class="line">            &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">2</span>,<span class="number">29</span>&#125;&#125;;</span><br><span class="line">    <span class="comment">//解向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] b = &#123;-<span class="number">15</span>,<span class="number">27</span>,-<span class="number">23</span>,<span class="number">0</span>,-<span class="number">20</span>,<span class="number">12</span>,-<span class="number">7</span>,<span class="number">7</span>,<span class="number">10</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//LU矩阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] L_Matrix = <span class="keyword">new</span> <span class="keyword">double</span>[Row][Column];</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] U_Matrix = <span class="keyword">new</span> <span class="keyword">double</span>[Row][Column];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//逆矩阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] inverseMatrix = <span class="keyword">new</span> <span class="keyword">double</span>[Row][Column];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EMCP</span><span class="params">()</span></span>&#123;</span><br><span class="line">        P = <span class="keyword">new</span> <span class="keyword">double</span>[Row][Column];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Row; i ++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; Column; j ++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i == j)</span><br><span class="line">                    P[i][j] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    P[i][j] = <span class="number">0</span>;</span><br><span class="line">                inverseMatrix[i][j] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对矩阵进行列主元LU分解</span></span><br><span class="line"><span class="comment">     * 更新LU矩阵，更新初始矩阵将其化为上三角矩阵</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LU_cpFactorization</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//初始化L矩阵对角元</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Row; i ++)</span><br><span class="line">            L_Matrix[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> Max;</span><br><span class="line">        <span class="comment">//按行进行消元</span></span><br><span class="line">        <span class="keyword">for</span>(; i &lt; Row - <span class="number">1</span>; i++, j++)&#123;</span><br><span class="line">            Max = Matrix[i][i];</span><br><span class="line">            <span class="keyword">int</span> target = i;</span><br><span class="line">            <span class="comment">//找出最大列主元所在行</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k &lt; Column; k++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(abs(Max) &lt; abs(Matrix[k][i])) &#123;</span><br><span class="line">                    Max = Matrix[k][i];</span><br><span class="line">                    target = k;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//若初始行不是最大列主元所在行，进行行变换</span></span><br><span class="line">            <span class="keyword">if</span>(i != target)</span><br><span class="line">                swap(i, target);</span><br><span class="line">            <span class="comment">//更新U矩阵第i行</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = i; k &lt; Column; k ++)</span><br><span class="line">                U_Matrix[i][k] = Matrix[i][k];</span><br><span class="line">            <span class="comment">//更新L矩阵第i列</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k &lt; Row; k ++)&#123;</span><br><span class="line">                <span class="comment">//获取行间商</span></span><br><span class="line">                <span class="keyword">double</span> Quotient = Matrix[k][i] / Matrix[i][i];</span><br><span class="line">                <span class="keyword">if</span>(Quotient == <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="comment">//首位置0</span></span><br><span class="line">                Matrix[k][i] = <span class="number">0</span>;</span><br><span class="line">                L_Matrix[k][i] = Quotient;</span><br><span class="line">                <span class="comment">//更新行</span></span><br><span class="line">                <span class="keyword">if</span>(Quotient != <span class="number">0</span>)</span><br><span class="line">                    updateRaw(Quotient, k, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        U_Matrix[Row - <span class="number">1</span>][Column - <span class="number">1</span>] = Matrix[Row - <span class="number">1</span>][Column - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对矩阵进行LU分解</span></span><br><span class="line"><span class="comment">     * 更新LU矩阵，更新初始矩阵将其化为上三角矩阵</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LU_Factorization</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//初始化L矩阵对角元</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Row; i ++)</span><br><span class="line">            L_Matrix[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> Max;</span><br><span class="line">        <span class="comment">//按行进行消元</span></span><br><span class="line">        <span class="keyword">for</span>(; i &lt; Row - <span class="number">1</span>; i++, j++)&#123;</span><br><span class="line">            <span class="comment">//更新U矩阵第i行</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = i; k &lt; Column; k ++)</span><br><span class="line">                U_Matrix[i][k] = Matrix[i][k];</span><br><span class="line">            <span class="comment">//更新L矩阵第i列</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k &lt; Row; k ++)&#123;</span><br><span class="line">                <span class="comment">//获取行间商</span></span><br><span class="line">                <span class="keyword">double</span> Quotient = Matrix[k][i] / Matrix[i][i];</span><br><span class="line">                <span class="keyword">if</span>(Quotient == <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="comment">//首位置0</span></span><br><span class="line">                Matrix[k][i] = <span class="number">0</span>;</span><br><span class="line">                L_Matrix[k][i] = Quotient;</span><br><span class="line">                <span class="comment">//更新行</span></span><br><span class="line">                <span class="keyword">if</span>(Quotient != <span class="number">0</span>)</span><br><span class="line">                    updateRaw(Quotient, k, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        U_Matrix[Row - <span class="number">1</span>][Column - <span class="number">1</span>] = Matrix[Row - <span class="number">1</span>][Column - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 寻找列主元后进行行变换</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> i 待交换行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> j 目标交换行</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> temp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; Column; k++)&#123;</span><br><span class="line">            temp = Matrix[i][k];</span><br><span class="line">            Matrix[i][k] = Matrix[j][k];</span><br><span class="line">            Matrix[j][k] = temp;</span><br><span class="line"></span><br><span class="line">            temp = P[i][k];</span><br><span class="line">            P[i][k] = P[j][k];</span><br><span class="line">            P[j][k] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * LU分解，更新矩阵的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> quotient 两行之间比例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> row 当前待更新的行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> column 待更新的行的第一个元素所在列</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateRaw</span><span class="params">(<span class="keyword">double</span> quotient, <span class="keyword">int</span> row, <span class="keyword">int</span> column)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(; column &lt; Column; column ++)</span><br><span class="line">            Matrix[row][column] = Matrix[row][column] - quotient * Matrix[row - <span class="number">1</span>][column];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算解向量</span></span><br><span class="line"><span class="comment">     * 先根据Ly=b，计算y，正序遍历，利用部分和化为1元1次方程组求y</span></span><br><span class="line"><span class="comment">     * 再根据Ux=y，计算x，逆序遍历，同理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//解向量初始化</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Column; i ++) &#123;</span><br><span class="line">            result_y[i] = <span class="number">0</span>;</span><br><span class="line">            result_x[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">double</span> partSum = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//利用Ly = b求解y</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Column; i ++) &#123;</span><br><span class="line">            partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                partSum = partSum + result_y[j] * L_Matrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            result_y[i] = (b[i] - partSum) / L_Matrix[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//利用Ux = y求解x</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = Column - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">            partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = Column - <span class="number">1</span>; j &gt; i; j--) &#123;</span><br><span class="line">                partSum = partSum + result_x[j] * U_Matrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            result_x[i] = (result_y[i] - partSum) / U_Matrix[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算原矩阵的逆</span></span><br><span class="line"><span class="comment">     * 利用Ly = ei Uai = y</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInverseMatrix</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> partSum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; Row; k ++) &#123;</span><br><span class="line">            <span class="comment">//利用Ly = b求解y</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Row; i ++)</span><br><span class="line">                b[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Column; i ++) &#123;</span><br><span class="line">                result_y[i] = <span class="number">0</span>;</span><br><span class="line">                result_x[i] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            b[k] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Column; i++) &#123;</span><br><span class="line">                partSum = <span class="number">0</span>;</span><br><span class="line">                <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                    partSum = partSum + result_y[j] * L_Matrix[i][j];</span><br><span class="line">                &#125;</span><br><span class="line">                result_y[i] = (b[i] - partSum) / L_Matrix[i][i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//利用Ux = y求解x</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = Column - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                partSum = <span class="number">0</span>;</span><br><span class="line">                <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = Column - <span class="number">1</span>; j &gt; i; j--) &#123;</span><br><span class="line">                    partSum = partSum + result_x[j] * U_Matrix[i][j];</span><br><span class="line">                &#125;</span><br><span class="line">                result_x[i] = (result_y[i] - partSum) / U_Matrix[i][i];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Row; i ++)&#123;</span><br><span class="line">                inverseMatrix[i][k] = result_x[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 因为LU矩阵分别为下，上三角阵，行列式为对角元之积</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 行列式的值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getDeterminant</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> l = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> u = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Row; i ++)&#123;</span><br><span class="line">            l = l * L_Matrix[i][i];</span><br><span class="line">            u = u * U_Matrix[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l * u;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="结果-1"><a href="#结果-1" class="headerlink" title="结果"></a>结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">逆矩阵</span><br><span class="line">[0.03894840265471074, 0.01595388325354099, 0.005784075484743884, 0.0035721390745191524, 0.007136051638908616, 0.01736063829564352, 0.012449737091243949, 0.0012279347186102522, 0.001141853652479522]</span><br><span class="line">[0.015857818644608744, 0.0378147983063747, 0.013040699815911189, 0.006392850953587455, 0.011877126791560352, 0.009346156617620205, 0.006418542249593486, 0.002036012705715857, 0.0020349359363873868]</span><br><span class="line">[0.004864298694204125, 0.011599481501563683, 0.03808288550334169, 0.007617411708951941, 0.006659031397314435, 0.0036339476905682807, 0.002434817417794583, 0.0010717289938677985, 0.0023528586727059246]</span><br><span class="line">[8.07289171884918E-4, 0.0019250741791101888, 0.0063203152260391865, 0.017860410439522308, 0.00995358321927043, 0.002853696884903487, 0.0017712459705290697, 0.0014899484458459032, 0.0054624195426397175]</span><br><span class="line">[4.4688452747539305E-4, 0.0010656477193643989, 0.0034986857022859833, 0.009886842729658587, 0.0239090439839064, 0.006247423141656982, 0.0037171854354044946, 0.004150157492119231, 0.003200266566997403]</span><br><span class="line">[1.2488399161191606E-4, 2.978002876899536E-4, 9.777242420214965E-4, 0.0027629248913456804, 0.006681495251588253, 0.041667975113588655, 0.030250080058384705, 0.0011597811102611675, 8.943296053829156E-4]</span><br><span class="line">[9.137853044774343E-5, 2.1790264952923434E-4, 7.154079819669486E-4, 0.0020216523595212297, 0.004888898964576769, 0.0304887622782356, 0.04652444882320832, 8.486203245813421E-4, 6.543875161338406E-4]</span><br><span class="line">[7.591099365329034E-5, 1.81018523327077E-4, 5.943117109949911E-4, 0.001679449633090103, 0.003487508748686805, -0.004236722653555438, -0.010601673941301766, 0.03674841118071818, 0.0024564601603960065]</span><br><span class="line">[1.918135347339413E-4, 4.574015059040139E-4, 0.001501719639455472, 0.004243669526998351, 2.7460453689195425E-4, 1.8665363910924237E-4, 4.516327146350918E-4, -0.0019462319422698404, 0.034666062236839594]</span><br><span class="line"></span><br><span class="line">行列式</span><br><span class="line">6.6824789473911836E13</span><br><span class="line"></span><br><span class="line">解</span><br><span class="line">[-0.28803238143825444, 0.3474791749739942, -0.711271134347599, -0.2176717739541517, -0.42657888255313675, 0.15537669007521887, -0.05704144628642523, 0.22550401651384522, 0.3015564086324566]</span><br></pre></td></tr></table></figure>

<h2 id="2-6-Hilbert矩阵求解"><a href="#2-6-Hilbert矩阵求解" class="headerlink" title="2.6 Hilbert矩阵求解"></a>2.6 Hilbert矩阵求解</h2><h3 id="利用LU分解计算"><a href="#利用LU分解计算" class="headerlink" title="利用LU分解计算"></a>利用LU分解计算</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.DecimalFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 利用LU分解求解Hilbert矩阵</span></span><br><span class="line"><span class="comment"> * 误差向上积累</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hilbert</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Hilbert矩阵的阶数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N;</span><br><span class="line">    <span class="comment">//Hilbert矩阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] HilbertMatrix;</span><br><span class="line">    <span class="comment">//常数向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] b;</span><br><span class="line">    <span class="comment">//L阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] L_Matrix;</span><br><span class="line">    <span class="comment">//U阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] U_Matrix;</span><br><span class="line">    <span class="comment">//Ux = y解出的x解向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] result_x;</span><br><span class="line">    <span class="comment">//Ly = b解出的y解向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] result_y;</span><br><span class="line">    <span class="keyword">private</span> DecimalFormat df = <span class="keyword">new</span> DecimalFormat( <span class="string">"0.000000 "</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造函数</span></span><br><span class="line"><span class="comment">     * 构造并初始化Hilbert矩阵，解向量，LU矩阵</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n Hilbert矩阵的阶数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Hilbert</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        N = n;</span><br><span class="line">        HilbertMatrix = <span class="keyword">new</span> <span class="keyword">double</span>[n][n];</span><br><span class="line">        <span class="comment">//Hilbert矩阵构造</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                HilbertMatrix[i][j] = <span class="number">1</span>/(<span class="keyword">double</span>)(i + j + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        b = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        result_x = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        result_y = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++) &#123;</span><br><span class="line">            b[i] = <span class="number">1</span>;</span><br><span class="line">            result_x[i] = <span class="number">0</span>;</span><br><span class="line">            result_y[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        L_Matrix = <span class="keyword">new</span> <span class="keyword">double</span>[n][n];</span><br><span class="line">        U_Matrix = <span class="keyword">new</span> <span class="keyword">double</span>[n][n];</span><br><span class="line">        <span class="comment">//初始化LU矩阵</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)&#123;</span><br><span class="line">                L_Matrix[i][j] = <span class="number">0</span>;</span><br><span class="line">                U_Matrix[i][j] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对Hilbert矩阵进行LU分解</span></span><br><span class="line"><span class="comment">     * 更新LU矩阵，更新初始Hilbert矩阵将其化为上三角矩阵</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LU_Factorization</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//初始化L矩阵对角元</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            L_Matrix[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//按行进行消元</span></span><br><span class="line">        <span class="keyword">for</span>(; i &lt; N - <span class="number">1</span>; i++, j++)&#123;</span><br><span class="line">            <span class="comment">//Hilbert矩阵不需要进行列主元消元</span></span><br><span class="line">            <span class="comment">//更新U矩阵第i行</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = i; k &lt; N; k ++)</span><br><span class="line">                U_Matrix[i][k] = HilbertMatrix[i][k];</span><br><span class="line">            <span class="comment">//更新L矩阵第i列</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k &lt; N; k ++)&#123;</span><br><span class="line">                <span class="comment">//获取行间商</span></span><br><span class="line">                <span class="keyword">double</span> Quotient = HilbertMatrix[k][i] / HilbertMatrix[i][i];</span><br><span class="line">                <span class="keyword">if</span>(Quotient == <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="comment">//首位置0</span></span><br><span class="line">                HilbertMatrix[k][i] = <span class="number">0</span>;</span><br><span class="line">                L_Matrix[k][i] = Quotient;</span><br><span class="line">                <span class="comment">//更新行</span></span><br><span class="line">                <span class="keyword">if</span>(Quotient != <span class="number">0</span>)</span><br><span class="line">                    updateRaw(Quotient, k, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        U_Matrix[N - <span class="number">1</span>][N - <span class="number">1</span>] = HilbertMatrix[N - <span class="number">1</span>][N - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * LU分解，更新Hilbert矩阵的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> quotient 两行之间比例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> row 当前待更新的行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> column 待更新的行的第一个元素所在列</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateRaw</span><span class="params">(<span class="keyword">double</span> quotient, <span class="keyword">int</span> row, <span class="keyword">int</span> column)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(; column &lt; N; column ++)</span><br><span class="line">            HilbertMatrix[row][column] = HilbertMatrix[row][column] - quotient * HilbertMatrix[row - <span class="number">1</span>][column];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算解向量</span></span><br><span class="line"><span class="comment">     * 先根据Ly=b，计算y，正序遍历，利用部分和化为1元1次方程组求y</span></span><br><span class="line"><span class="comment">     * 再根据Ux=y，计算x，逆序遍历，同理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//解向量初始化</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">            result_y[i] = <span class="number">0</span>;</span><br><span class="line">            result_x[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">double</span> partSum = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//利用Ly = b求解y</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">            partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                partSum = partSum + result_y[j] * L_Matrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            result_y[i] = (b[i] - partSum) / L_Matrix[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//利用Ux = y求解x</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">            partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = N - <span class="number">1</span>; j &gt; i; j--) &#123;</span><br><span class="line">                partSum = partSum + result_x[j] * U_Matrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            result_x[i] = (result_y[i] - partSum) / U_Matrix[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出矩阵结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMatrix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            System.out.println(Arrays.toString(HilbertMatrix[i]));</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            System.out.println(Arrays.toString(L_Matrix[i]));</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            System.out.println(Arrays.toString(U_Matrix[i]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出解向量结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            System.out.println(df.format(result_y[i]));</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            System.out.println(df.format(result_x[i]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="利用增广矩阵Gauss消元法实现"><a href="#利用增广矩阵Gauss消元法实现" class="headerlink" title="利用增广矩阵Gauss消元法实现"></a>利用增广矩阵Gauss消元法实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.DecimalFormat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  利用增广矩阵Gauss消元法实现</span></span><br><span class="line"><span class="comment"> *  误差向下积累</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hilbert2</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Hilbert矩阵阶数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N;</span><br><span class="line">    <span class="comment">//Hilbert增广矩阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] HilbertMatrix;</span><br><span class="line">    <span class="comment">//解向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] result;</span><br><span class="line">    <span class="keyword">private</span> DecimalFormat df = <span class="keyword">new</span> DecimalFormat( <span class="string">"0.000000 "</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造函数</span></span><br><span class="line"><span class="comment">     * 构造并初始化增广Hilbert矩阵，解向量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Hilbert2</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        N = n;</span><br><span class="line">        HilbertMatrix = <span class="keyword">new</span> <span class="keyword">double</span>[n][n + <span class="number">1</span>];</span><br><span class="line">        <span class="comment">//Hilbert增广矩阵构造</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                HilbertMatrix[i][j] = <span class="number">1</span>/(<span class="keyword">double</span>)(i + j + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        result = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++) &#123;</span><br><span class="line">            result[i] = <span class="number">0</span>;</span><br><span class="line">            HilbertMatrix[i][n] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 增广矩阵按行进行Gauss消元</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">factorization</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//按行进行消元</span></span><br><span class="line">        <span class="keyword">for</span>(; i &lt; N - <span class="number">1</span>; i++, j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k &lt; N; k ++)&#123;</span><br><span class="line">                <span class="comment">//获取行间商</span></span><br><span class="line">                <span class="keyword">double</span> Quotient = HilbertMatrix[k][i] / HilbertMatrix[i][i];</span><br><span class="line">                <span class="keyword">if</span>(Quotient == <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="comment">//首位置0</span></span><br><span class="line">                HilbertMatrix[k][i] = <span class="number">0</span>;</span><br><span class="line">                <span class="comment">//更新行</span></span><br><span class="line">                <span class="keyword">if</span>(Quotient != <span class="number">0</span>)</span><br><span class="line">                    updateRaw(Quotient, k, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 按行更新增广Hilbert矩阵</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> quotient 两行之间比例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> row 当前待更新的行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> column 待更新的行的第一个元素所在列</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateRaw</span><span class="params">(<span class="keyword">double</span> quotient, <span class="keyword">int</span> row, <span class="keyword">int</span> column)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(; column &lt; N + <span class="number">1</span>; column ++)</span><br><span class="line">            HilbertMatrix[row][column] = HilbertMatrix[row][column] - quotient * HilbertMatrix[row - <span class="number">1</span>][column];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 直接逆序按行遍历增广矩阵，利用部分和化为1元1次方程组求解x</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> partSum = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//利用Hx = b求解x</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">            partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = N - <span class="number">1</span>; j &gt; i; j--) &#123;</span><br><span class="line">                partSum = partSum + result[j] * HilbertMatrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            result[i] = (HilbertMatrix[i][N] - partSum) / HilbertMatrix[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出解向量结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            System.out.println(df.format(result[i]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出矩阵结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMatrix</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N + <span class="number">1</span>; j++)</span><br><span class="line">                System.out.print(df.format(HilbertMatrix[i][j]) + <span class="string">" "</span>);</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="结果-2"><a href="#结果-2" class="headerlink" title="结果"></a>结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">n=2的Hilbert矩阵利用LU分解求解：</span><br><span class="line">-2.000000 6.000000 </span><br><span class="line">利用增广矩阵Gauss消元求解：</span><br><span class="line">-2.000000 6.000000 </span><br><span class="line"></span><br><span class="line">n=5的Hilbert矩阵利用LU分解求解：</span><br><span class="line">0.952791 14.555663 -41.248891 -66.171944 115.309973 </span><br><span class="line">利用增广矩阵Gauss消元求解：</span><br><span class="line">-0.232735 -0.694776 0.300523 -4.744569 13.330457 </span><br><span class="line"></span><br><span class="line">n=10的Hilbert矩阵利用LU分解求解：</span><br><span class="line">-88362050531657580000.000000 -257825283170962300000.000000 105691493935800520000.000000 321443398219438100000.000000 -21707058806388433000.000000 -42134045878669104.000000 -95851220811.950450 -156349522621727060000000.000000 443697662848130800000000.000000 -296500182100434630000000.000000 </span><br><span class="line">利用增广矩阵Gauss消元求解：</span><br><span class="line">-0.200823 -0.609366 0.269812 0.836271 -0.055616 -0.000107 0.000000 7.555673 9.658641 -8.000000</span><br></pre></td></tr></table></figure>

<h2 id="2-7-Jacobi迭代与GS迭代"><a href="#2-7-Jacobi迭代与GS迭代" class="headerlink" title="2.7 Jacobi迭代与GS迭代"></a>2.7 Jacobi迭代与GS迭代</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.DecimalFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.abs;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Jacobi_GS</span> </span>&#123;</span><br><span class="line">    <span class="comment">//系数矩阵阶数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N;</span><br><span class="line">    <span class="comment">//迭代计数器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> iterationNum;</span><br><span class="line">    <span class="comment">//系数矩阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] Matrix;</span><br><span class="line">    <span class="comment">//常数向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] b;</span><br><span class="line">    <span class="comment">//解向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] result;</span><br><span class="line">    <span class="keyword">private</span> DecimalFormat df = <span class="keyword">new</span> DecimalFormat( <span class="string">"0.000000 "</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造并初始化严格对角占优矩阵，解向量，常数向量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n 严格对角占优矩阵阶数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Jacobi_GS</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        N = n;</span><br><span class="line">        Matrix = <span class="keyword">new</span> <span class="keyword">double</span>[n][n];</span><br><span class="line">        b = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        result = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        <span class="comment">//构造并初始化严格对角占优矩阵，解向量，常数向量</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                Matrix[i][j] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            result[i] = <span class="number">0</span>;</span><br><span class="line">            b[i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//严格对角占优矩阵，常数向量赋值</span></span><br><span class="line">        b[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">        b[n - <span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line">        Matrix[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">3</span>;</span><br><span class="line">        Matrix[<span class="number">0</span>][<span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line">        Matrix[n - <span class="number">1</span>][n - <span class="number">2</span>] = -<span class="number">1</span>;</span><br><span class="line">        Matrix[n - <span class="number">1</span>][n - <span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n - <span class="number">1</span>; i ++)&#123;</span><br><span class="line">                Matrix[i][i] = <span class="number">3</span>;</span><br><span class="line">                Matrix[i][i - <span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line">                Matrix[i][i + <span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        iterationNum = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 进行Jacobi n次迭代</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Jacobi</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (getJacobi())</span><br><span class="line">            iterationNum ++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 进行Jacobi迭代获取解向量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">getJacobi</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//因为Jacobi迭代完成一次迭代后才更新x，利用temp数组暂存更新的x</span></span><br><span class="line">        <span class="keyword">double</span>[] temp = <span class="keyword">new</span> <span class="keyword">double</span>[N];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)&#123;</span><br><span class="line">            <span class="comment">//计算系数矩阵当前行与解向量乘积的部分和</span></span><br><span class="line">            <span class="keyword">double</span> partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j ++)</span><br><span class="line">                partSum = partSum + Matrix[i][j] * result[j];</span><br><span class="line">            <span class="comment">//将对角元素排除</span></span><br><span class="line">            partSum = partSum - Matrix[i][i] * result[i];</span><br><span class="line">            temp[i] = <span class="number">1</span> / Matrix[i][i] * (b[i] - partSum);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//判断解向量精度</span></span><br><span class="line">        <span class="keyword">boolean</span> ret = judgeResult(temp);</span><br><span class="line">        <span class="comment">//更新解向量</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            result[i] = temp[i];</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 进行GS n次迭代</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GS</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (getGS())</span><br><span class="line">            iterationNum ++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 进行GS迭代获取解向量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Boolean <span class="title">getGS</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span>[] temp = <span class="keyword">new</span> <span class="keyword">double</span>[N];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            temp[i] = result[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)&#123;</span><br><span class="line">            <span class="comment">//计算系数矩阵当前行与解向量乘积的部分和</span></span><br><span class="line">            <span class="keyword">double</span> partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j ++)</span><br><span class="line">                partSum = partSum + Matrix[i][j] * result[j];</span><br><span class="line">            <span class="comment">//将对角元素排除</span></span><br><span class="line">            partSum = partSum - Matrix[i][i] * result[i];</span><br><span class="line">            result[i] = <span class="number">1</span> / Matrix[i][i] * (b[i] - partSum);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//判断解向量精度</span></span><br><span class="line">        <span class="keyword">boolean</span> ret = judgeResult(temp);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 比较两次迭代解之间的变化量，当解向量的变化量小于1.0E-6时停止迭代</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> temp Jacobi迭代的第i次迭代解向量，GS迭代的第i-1次迭代向量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 不满足精度，返回true，迭代继续，满足返回false，结束迭代</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">judgeResult</span><span class="params">(<span class="keyword">double</span>[] temp)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            <span class="keyword">if</span>(abs(temp[i] - result[i]) &gt; <span class="number">1.0E-6</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出对角占优矩阵</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMatrix</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++)</span><br><span class="line">                System.out.print(df.format(Matrix[i][j]));</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出解向量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">            System.out.print(df.format(result[i]));</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getIterationNum</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> iterationNum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="结果-3"><a href="#结果-3" class="headerlink" title="结果"></a>结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">精度为0.000001</span><br><span class="line"></span><br><span class="line">n = 10时，Jacobi迭代的解为：</span><br><span class="line">1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 </span><br><span class="line">n = 10时，Jacobi迭代的次数：</span><br><span class="line">30</span><br><span class="line"></span><br><span class="line">n = 20时，Jacobi迭代的解为：</span><br><span class="line">1.000000 1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 1.000000 </span><br><span class="line">n = 20时，Jacobi迭代的次数：</span><br><span class="line">32</span><br><span class="line"></span><br><span class="line">n = 30时，Jacobi迭代的解为：</span><br><span class="line">1.000000 1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 1.000000 </span><br><span class="line">n = 30时，Jacobi迭代的次数：</span><br><span class="line">32</span><br><span class="line"></span><br><span class="line">n = 50时，Jacobi迭代的解为：</span><br><span class="line">1.000000 1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 1.000000 </span><br><span class="line">n = 50时，Jacobi迭代的次数：</span><br><span class="line">32</span><br><span class="line"></span><br><span class="line">n = 100时，Jacobi迭代的解为：</span><br><span class="line">1.000000 1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999998 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 1.000000 </span><br><span class="line">n = 100时，Jacobi迭代的次数：</span><br><span class="line">32</span><br><span class="line"></span><br><span class="line">n = 10时，GS迭代的解为：</span><br><span class="line">1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 </span><br><span class="line">n = 10时，GS迭代的次数：</span><br><span class="line">18</span><br><span class="line"></span><br><span class="line">n = 20时，GS迭代的解为：</span><br><span class="line">1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 </span><br><span class="line">n = 20时，GS迭代的次数：</span><br><span class="line">19</span><br><span class="line"></span><br><span class="line">n = 30时，GS迭代的解为：</span><br><span class="line">1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 </span><br><span class="line">n = 30时，GS迭代的次数：</span><br><span class="line">19</span><br><span class="line"></span><br><span class="line">n = 30时，GS迭代的解为：</span><br><span class="line">1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 </span><br><span class="line">n = 30时，GS迭代的次数：</span><br><span class="line">19</span><br><span class="line"></span><br><span class="line">n = 100时，GS迭代的解为：</span><br><span class="line">1.000000 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 0.999999 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 </span><br><span class="line">n = 100时，GS迭代的次数：</span><br><span class="line">19</span><br></pre></td></tr></table></figure>

<h2 id="3-1-Newton迭代法和割线法"><a href="#3-1-Newton迭代法和割线法" class="headerlink" title="3.1 Newton迭代法和割线法"></a>3.1 Newton迭代法和割线法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Newton_Secant</span> </span>&#123;</span><br><span class="line">    <span class="comment">//非线性方程组系数向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] coefficientArr;</span><br><span class="line">    <span class="comment">//非线性方程组最大幂次</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxPower;</span><br><span class="line">    <span class="comment">//迭代计数器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> iterationNum;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造函数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mp 多项式最高项系数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Newton_Secant</span><span class="params">(<span class="keyword">int</span> mp)</span></span>&#123;</span><br><span class="line">        maxPower = mp;</span><br><span class="line">        coefficientArr = <span class="keyword">new</span> <span class="keyword">double</span>[mp + <span class="number">1</span>];</span><br><span class="line">        iterationNum = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输入系数向量，从低次到高次</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> coefficientArr 系数向量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCoefficientArr</span><span class="params">(<span class="keyword">double</span>[] coefficientArr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.coefficientArr = coefficientArr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 非线性方程组获取Newton迭代法的f(x)部分</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x 当前x的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> f(x)的值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">getFx</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= maxPower; i ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(coefficientArr[i] != <span class="number">0</span>)</span><br><span class="line">                result = result + pow(x, i) * coefficientArr[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 非线性方程组获取Newton迭代法的f'(x)部分</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x 当前x的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> f‘(x)的值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">getdF</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxPower; i ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(coefficientArr[i] != <span class="number">0</span>)</span><br><span class="line">                result = result + i * pow(x, i - <span class="number">1</span>) * coefficientArr[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用Newton法求非线性方程组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x 初始x值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Newton法迭代后获取的x值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">Newton</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> x1 = x - getFx(x) / getdF(x);</span><br><span class="line">        iterationNum = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (abs(x1 - x) &gt; <span class="number">1.0E-6</span>)&#123;</span><br><span class="line">            x = x1;</span><br><span class="line">            x1 = x - getFx(x) / getdF(x);</span><br><span class="line">            iterationNum ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用割线法求非线性方程组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x0 初始x0的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x1 初值x1的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 割线法迭代后获取的x值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">secantMethod</span><span class="params">(<span class="keyword">double</span> x0, <span class="keyword">double</span> x1)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> x2 = x1 - getFx(x1) / (getFx(x1) - getFx(x0)) * (x1 - x0);</span><br><span class="line">        iterationNum = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (abs(x2 - x1) &gt; <span class="number">1.0E-6</span>)&#123;</span><br><span class="line">            x0 = x1;</span><br><span class="line">            x1 = x2;</span><br><span class="line">            x2 = x1 - getFx(x1) / (getFx(x1) - getFx(x0)) * (x1 - x0);</span><br><span class="line">            iterationNum ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * e^xsinx利用Newton法求解</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x 初始x值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Newton法迭代后获取的x值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">expSin_Newton</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> x1 = x - (exp(x) * sin(x)) / (exp(x) * (sin(x) + cos(x)));</span><br><span class="line">        iterationNum = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (abs(x1 - x) &gt; <span class="number">1.0E-6</span>)&#123;</span><br><span class="line">            x = x1;</span><br><span class="line">            x1 = x - (exp(x) * sin(x)) / (exp(x) * (sin(x) + cos(x)));</span><br><span class="line">            iterationNum ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * e^xsinx利用割线法求解</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x0 初始x0的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x1 初值x1的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 割线法迭代后获取的x值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">expsin_SecantMethod</span><span class="params">(<span class="keyword">double</span> x0, <span class="keyword">double</span> x1)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> x2 = x1 - (exp(x1) * sin(x1)) / (exp(x1) * sin(x1) - exp(x0) * sin(x0)) * (x1 - x0);</span><br><span class="line">        iterationNum = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (abs(x2 - x1) &gt; <span class="number">1.0E-6</span>)&#123;</span><br><span class="line">            x0 = x1;</span><br><span class="line">            x1 = x2;</span><br><span class="line">            x2 = x1 - (exp(x1) * sin(x1)) / (exp(x1) * sin(x1) - exp(x0) * sin(x0)) * (x1 - x0);</span><br><span class="line">            iterationNum ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getIterationNum</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> iterationNum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="结果-4"><a href="#结果-4" class="headerlink" title="结果"></a>结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">非线性方程组2x^3-5x+1=0 在[1,2]上的根</span><br><span class="line"></span><br><span class="line">Newton迭代法求解：</span><br><span class="line">1.469617  </span><br><span class="line">迭代次数：</span><br><span class="line">4</span><br><span class="line"></span><br><span class="line">割线法迭代法求解：</span><br><span class="line">1.469617 </span><br><span class="line">迭代次数：</span><br><span class="line">4</span><br><span class="line"></span><br><span class="line">e^xsinx=0 在[-4,-3]上的根</span><br><span class="line"></span><br><span class="line">Newton迭代法求解：</span><br><span class="line">-3.141593 </span><br><span class="line">迭代次数：</span><br><span class="line">6</span><br><span class="line"></span><br><span class="line">割线法迭代法求解：</span><br><span class="line">-3.141593 </span><br><span class="line">迭代次数：</span><br><span class="line">7</span><br></pre></td></tr></table></figure>

<h2 id="3-4-Newton迭代法"><a href="#3-4-Newton迭代法" class="headerlink" title="3.4 Newton迭代法"></a>3.4 Newton迭代法</h2><p><strong>在3.1题中加入下述方法即可</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 非线性方程，自定义迭代次数Newton迭代法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x 初始x值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n 迭代次数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Newton法迭代后获取的x值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">Newton</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">            x = x - getFx(x) / getdF(x);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="数据表"><a href="#数据表" class="headerlink" title="数据表"></a>数据表</h3><table>
<thead>
<tr>
<th align="center">$i$</th>
<th align="center">$x_i$</th>
<th align="center">$e_i=|x_i-x^{*}|$</th>
<th align="center">$\dfrac{e_i}{e_{i-1}^2}$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$0$</td>
<td align="center">$-0.7$</td>
<td align="center">$1.7$</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">$1$</td>
<td align="center">$2.620561$</td>
<td align="center">$1.620561$</td>
<td align="center">$0.560748$</td>
</tr>
<tr>
<td align="center">$2$</td>
<td align="center">$1.708440$</td>
<td align="center">$0.708440$</td>
<td align="center">$0.269757$</td>
</tr>
<tr>
<td align="center">$3$</td>
<td align="center">$1.206379$</td>
<td align="center">$0.206379$</td>
<td align="center">$0.411205$</td>
</tr>
<tr>
<td align="center">$4$</td>
<td align="center">$1.024162$</td>
<td align="center">$0.024162$</td>
<td align="center">$0.567280$</td>
</tr>
<tr>
<td align="center">$5$</td>
<td align="center">$1.000381$</td>
<td align="center">$0.000381$</td>
<td align="center">$0.653478$</td>
</tr>
<tr>
<td align="center">$6$</td>
<td align="center">$1.000000$</td>
<td align="center">$0.000000$</td>
<td align="center">$0.666455$</td>
</tr>
<tr>
<td align="center">$7$</td>
<td align="center">$1.000000$</td>
<td align="center">$0.000000$</td>
<td align="center">$0.660875$</td>
</tr>
</tbody></table>
$\dfrac{f''(x^{*})}{2f'(x^{*})}=\dfrac{1}{3}=0.666667$


<p>越来越接近</p>
<h2 id="4-7-三次样条插值"><a href="#4-7-三次样条插值" class="headerlink" title="4.7 三次样条插值"></a>4.7 三次样条插值</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.DecimalFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.pow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CubicSplineInterpolation</span> </span>&#123;</span><br><span class="line">    <span class="comment">//三次样条提供的点数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N;</span><br><span class="line">    <span class="comment">//三次样条提供的点的值</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] pointArr;</span><br><span class="line">    <span class="comment">//三次样条提供的点对应的值</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] sArr;</span><br><span class="line">    <span class="comment">//严格对角占优系数矩阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] Matrix;</span><br><span class="line">    <span class="comment">//L阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] L_Matrix;</span><br><span class="line">    <span class="comment">//U阵</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[][] U_Matrix;</span><br><span class="line">    <span class="comment">//g向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] g;</span><br><span class="line">    <span class="comment">//Ux = y解出的x解向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] result_x;</span><br><span class="line">    <span class="comment">//Ly = b解出的y解向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] result_y;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DecimalFormat df = <span class="keyword">new</span> DecimalFormat( <span class="string">"0.000000 "</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造函数</span></span><br><span class="line"><span class="comment">     * 初始化各种矩阵</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n 三次样条提供的点的值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    CubicSplineInterpolation(<span class="keyword">int</span> n)&#123;</span><br><span class="line">        N = n;</span><br><span class="line">        Matrix = <span class="keyword">new</span> <span class="keyword">double</span>[n][n];</span><br><span class="line">        L_Matrix = <span class="keyword">new</span> <span class="keyword">double</span>[n][n];</span><br><span class="line">        U_Matrix = <span class="keyword">new</span> <span class="keyword">double</span>[n][n];</span><br><span class="line">        result_x = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        result_y = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        g = <span class="keyword">new</span> <span class="keyword">double</span>[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)&#123;</span><br><span class="line">            g[i] = <span class="number">0</span>;</span><br><span class="line">            result_y[i] = <span class="number">0</span>;</span><br><span class="line">            result_x[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j ++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i != j) &#123;</span><br><span class="line">                    Matrix[i][j] = <span class="number">0</span>;</span><br><span class="line">                    L_Matrix[i][j] = <span class="number">0</span>;</span><br><span class="line">                    U_Matrix[i][j] = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    Matrix[i][j] = <span class="number">2</span>;</span><br><span class="line">                    L_Matrix[i][j] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//已知题目为第二边界条件</span></span><br><span class="line">        Matrix[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        Matrix[n - <span class="number">1</span>][n - <span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算lambda和mu，生成严格对角占优矩阵</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getMatrix</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(pointArr.length != <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N - <span class="number">1</span>; i ++)&#123;</span><br><span class="line">                Matrix[i][i - <span class="number">1</span>] = (pointArr[i + <span class="number">1</span>] - pointArr[i]) / ((pointArr[i + <span class="number">1</span>] - pointArr[i]) + (pointArr[i] - pointArr[i - <span class="number">1</span>]));</span><br><span class="line">                Matrix[i][i + <span class="number">1</span>] = <span class="number">1</span> - Matrix[i][i - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对严格对角占优矩阵进行LU分解</span></span><br><span class="line"><span class="comment">     * 更新LU矩阵，更新初始严格对角占优矩阵将其化为上三角矩阵</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LU_Factorization</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//初始化L矩阵对角元</span></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//按行进行消元</span></span><br><span class="line">        <span class="keyword">for</span>(; i &lt; N - <span class="number">1</span>; i++, j++)&#123;</span><br><span class="line">            <span class="comment">//Hilbert矩阵不需要进行列主元消元</span></span><br><span class="line">            <span class="comment">//更新U矩阵第i行</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = i; k &lt; N; k ++)</span><br><span class="line">                U_Matrix[i][k] = Matrix[i][k];</span><br><span class="line">            <span class="comment">//更新L矩阵第i列</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k &lt; N; k ++)&#123;</span><br><span class="line">                <span class="comment">//获取行间商</span></span><br><span class="line">                <span class="keyword">double</span> Quotient = Matrix[k][i] / Matrix[i][i];</span><br><span class="line">                <span class="keyword">if</span>(Quotient == <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="comment">//首位置0</span></span><br><span class="line">                Matrix[k][i] = <span class="number">0</span>;</span><br><span class="line">                L_Matrix[k][i] = Quotient;</span><br><span class="line">                <span class="comment">//更新行</span></span><br><span class="line">                <span class="keyword">if</span>(Quotient != <span class="number">0</span>)</span><br><span class="line">                    updateRaw(Quotient, k, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        U_Matrix[N - <span class="number">1</span>][N - <span class="number">1</span>] = Matrix[N - <span class="number">1</span>][N - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * LU分解，更新严格对角占优矩阵的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> quotient 两行之间比例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> row 当前待更新的行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> column 待更新的行的第一个元素所在列</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateRaw</span><span class="params">(<span class="keyword">double</span> quotient, <span class="keyword">int</span> row, <span class="keyword">int</span> column)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(; column &lt; N; column ++)</span><br><span class="line">            Matrix[row][column] = Matrix[row][column] - quotient * Matrix[row - <span class="number">1</span>][column];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据边界条件值（此处为第二边界条件），计算常数向量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> f0 第一个点处二阶导函数值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fn 第n个点处二阶导函数值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getBoundaryArr</span><span class="params">(<span class="keyword">double</span> f0, <span class="keyword">double</span> fn)</span></span>&#123;</span><br><span class="line">        g[<span class="number">0</span>] = <span class="number">3</span> * (sArr[<span class="number">1</span>] - sArr[<span class="number">0</span>]) / (pointArr[<span class="number">1</span>] - pointArr[<span class="number">0</span>]) - (pointArr[<span class="number">1</span>] - pointArr[<span class="number">0</span>]) / <span class="number">2</span> * f0;</span><br><span class="line">        g[N - <span class="number">1</span>] = <span class="number">3</span> * (sArr[N - <span class="number">1</span>] - sArr[N - <span class="number">2</span>]) / (pointArr[N - <span class="number">1</span>] - pointArr[N - <span class="number">2</span>]) - (pointArr[N - <span class="number">1</span>] - pointArr[N - <span class="number">2</span>]) / <span class="number">2</span> * f0;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N - <span class="number">1</span>; i ++)</span><br><span class="line">            g[i] = <span class="number">3</span> * (Matrix[i][i + <span class="number">1</span>] * (sArr[i + <span class="number">1</span>] - sArr[i]) / (pointArr[i + <span class="number">1</span>] - pointArr[i]) +</span><br><span class="line">                    Matrix[i][i - <span class="number">1</span>] * (sArr[i] - sArr[i - <span class="number">1</span>]) / (pointArr[i] - pointArr[i - <span class="number">1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算解向量</span></span><br><span class="line"><span class="comment">     * 先根据Ly=b，计算y，正序遍历，利用部分和化为1元1次方程组求y</span></span><br><span class="line"><span class="comment">     * 再根据Ux=y，计算x，逆序遍历，同理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> partSum = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//利用Ly = b求解y</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i ++) &#123;</span><br><span class="line">            partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                partSum = partSum + result_y[j] * L_Matrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            result_y[i] = (g[i] - partSum) / L_Matrix[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//利用Ux = y求解x</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">            partSum = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//已知解计算的部分和，全部转化为一元一次方程求解</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = N - <span class="number">1</span>; j &gt; i; j--) &#123;</span><br><span class="line">                partSum = partSum + result_x[j] * U_Matrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">            result_x[i] = (result_y[i] - partSum) / U_Matrix[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPointArr</span><span class="params">(<span class="keyword">double</span>[] pointArr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.pointArr = pointArr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setsArr</span><span class="params">(<span class="keyword">double</span>[] sArr)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sArr = sArr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="结果-5"><a href="#结果-5" class="headerlink" title="结果"></a>结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">区间[0,1]的方程为：1.0 * (x - 1.0)^2 + 4.660714  * (x - 0.0)(x 1.0)^2 + 3.0 * (x - 0.0)^2 - 6.678571  * (x - 1.0)(x 0.0)^2</span><br><span class="line">区间[1,2]的方程为：3.0 * (x - 2.0)^2 + 6.678571  * (x - 1.0)(x 2.0)^2 + 3.0 * (x - 1.0)^2 - 6.625000  * (x - 2.0)(x 1.0)^2</span><br><span class="line">区间[2,3]的方程为：3.0 * (x - 3.0)^2 + 6.625000  * (x - 2.0)(x 3.0)^2 + 4.0 * (x - 2.0)^2 - 7.821429  * (x - 3.0)(x 2.0)^2</span><br><span class="line">区间[3,4]的方程为：4.0 * (x - 4.0)^2 + 7.821429  * (x - 3.0)(x 4.0)^2 + 2.0 * (x - 3.0)^2 - 1.089286  * (x - 4.0)(x 3.0)^2</span><br></pre></td></tr></table></figure>

<h2 id="5-1-复化梯形与Simpson"><a href="#5-1-复化梯形与Simpson" class="headerlink" title="5.1 复化梯形与Simpson"></a>5.1 复化梯形与Simpson</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Trapezoid_Simpson</span> </span>&#123;</span><br><span class="line">    <span class="comment">//区间数量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Trapezoid_Simpson</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        N = n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用复化梯形求解e^3*cos(PI*x)在[a,b]上的积分</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin 起始值a</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end 终止值b</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 积分解</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getTrapezoid</span><span class="params">(<span class="keyword">double</span> begin, <span class="keyword">double</span> end)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = exp(<span class="number">3</span> * begin) * cos(PI * begin);</span><br><span class="line">        <span class="keyword">double</span> h = (end - begin) / N;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N - <span class="number">1</span>; i ++)&#123;</span><br><span class="line">            result = result + <span class="number">2</span> * exp(<span class="number">3</span> * i * h) * cos(PI * i * h);</span><br><span class="line">        &#125;</span><br><span class="line">        result = result + exp(<span class="number">3</span> * end) * cos(PI * end);</span><br><span class="line">        result = result * h / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用Simpson求解e^3*cos(PI*x)在[a,b]上的积分</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin 起始值a</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end 终止值b</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 积分解</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSimpson</span><span class="params">(<span class="keyword">double</span> begin, <span class="keyword">double</span> end)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = exp(<span class="number">3</span> * begin) * cos(PI * begin) + exp(<span class="number">3</span> * end) * cos(PI * end);</span><br><span class="line">        <span class="keyword">double</span> h = (end - begin) / N;</span><br><span class="line">        result = result + <span class="number">4</span> * exp(<span class="number">3</span> * begin + h / <span class="number">2</span>) * cos(PI * (begin + h / <span class="number">2</span>));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N - <span class="number">1</span>; i ++)&#123;</span><br><span class="line">            result = result + <span class="number">2</span> * exp(<span class="number">3</span> * i * h) * cos(PI * i * h) + <span class="number">4</span> * exp(<span class="number">3</span> * i * h + h / <span class="number">2</span>) * cos(PI * (i * h + h / <span class="number">2</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        result = result * h / <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>精确值为：</p>
<p>$\dfrac{1}{9+\pi^2}(3\cos\pi xe^{3x}|_0^{\frac{\pi}{2}}+\pi\sin \pi xe^{3x}|_0^{\frac{\pi}{2}}) = -14.331840$</p>
<table>
<thead>
<tr>
<th align="center">区间大小</th>
<th align="center">复化梯形求解</th>
<th align="center">复化梯形误差</th>
<th align="center">Simpson求解</th>
<th align="center">Simpson误差</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$50$</td>
<td align="center">$-14.690719$</td>
<td align="center">$0.358879$</td>
<td align="center">$-14.538056$</td>
<td align="center">$0.206216$</td>
</tr>
<tr>
<td align="center">$100$</td>
<td align="center">$-14.610622$</td>
<td align="center">$0.278782$</td>
<td align="center">$-14.498825$</td>
<td align="center">$0.166985$</td>
</tr>
<tr>
<td align="center">$200$</td>
<td align="center">$-14.497480$</td>
<td align="center">$0.165640$</td>
<td align="center">$-14.432189$</td>
<td align="center">$0.100349$</td>
</tr>
<tr>
<td align="center">$500$</td>
<td align="center">$-14.404580$</td>
<td align="center">$0.072740$</td>
<td align="center">$-14.376141$</td>
<td align="center">$0.044301$</td>
</tr>
<tr>
<td align="center">$1000$</td>
<td align="center">$-14.369306$</td>
<td align="center">$0.037466$</td>
<td align="center">$-14.354694$</td>
<td align="center">$0.022854$</td>
</tr>
</tbody></table>
<p><strong>由表可知，误差收敛</strong></p>

      
    </div>
    
    
    

    

    

    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-gittip"></i>感谢您的阅读-------------</div>
    
</div>

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Math/" rel="tag"># Math</a>
          
            <a href="/tags/Course/" rel="tag"># Course</a>
          
            <a href="/tags/Java/" rel="tag"># Java</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/01/ComputationalMethods1/" rel="next" title="计算方法知识点（5-7）">
                <i class="fa fa-chevron-left"></i> 计算方法知识点（5-7）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/08/AgileSoftwareDevelopment/" rel="prev" title="敏捷开发与DevOps">
                敏捷开发与DevOps <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
   <div id="gitalk-container"></div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">
      
        
      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Koo">
            
              <p class="site-author-name" itemprop="name">Koo</p>
              <p class="site-description motion-element" itemprop="description">I will not change no matter how U change</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Blanknesses" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:814161593@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
            <div>
              <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="210" height="110" src="//music.163.com/outchain/player?type=3&id=2063876922&auto=1&height=66"></iframe>
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hexo.io/zh-cn/docs/" title="Hexo" target="_blank">Hexo</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://theme-next.iissnan.com/getting-started.html" title="Next" target="_blank">Next</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://github.com/EbookFoundation/free-programming-books/blob/master/free-programming-books-zh.md" title="Programming-Book" target="_blank">Programming-Book</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://leetcode-cn.com/" title="LeetCode" target="_blank">LeetCode</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-向量范数计算"><span class="nav-number">1.</span> <span class="nav-text">1.4 向量范数计算</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#结果"><span class="nav-number">1.1.</span> <span class="nav-text">结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-高斯列主元"><span class="nav-number">2.</span> <span class="nav-text">2.1 高斯列主元</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#结果-1"><span class="nav-number">2.1.</span> <span class="nav-text">结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-Hilbert矩阵求解"><span class="nav-number">3.</span> <span class="nav-text">2.6 Hilbert矩阵求解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#利用LU分解计算"><span class="nav-number">3.1.</span> <span class="nav-text">利用LU分解计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#利用增广矩阵Gauss消元法实现"><span class="nav-number">3.2.</span> <span class="nav-text">利用增广矩阵Gauss消元法实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#结果-2"><span class="nav-number">3.3.</span> <span class="nav-text">结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-7-Jacobi迭代与GS迭代"><span class="nav-number">4.</span> <span class="nav-text">2.7 Jacobi迭代与GS迭代</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#结果-3"><span class="nav-number">4.1.</span> <span class="nav-text">结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-Newton迭代法和割线法"><span class="nav-number">5.</span> <span class="nav-text">3.1 Newton迭代法和割线法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#结果-4"><span class="nav-number">5.1.</span> <span class="nav-text">结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-Newton迭代法"><span class="nav-number">6.</span> <span class="nav-text">3.4 Newton迭代法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数据表"><span class="nav-number">6.1.</span> <span class="nav-text">数据表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-7-三次样条插值"><span class="nav-number">7.</span> <span class="nav-text">4.7 三次样条插值</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#结果-5"><span class="nav-number">7.1.</span> <span class="nav-text">结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-复化梯形与Simpson"><span class="nav-number">8.</span> <span class="nav-text">5.1 复化梯形与Simpson</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Koo</span>

  
</div>


<div class="powered-by">
<span id="busuanzi_container_site_uv">
  本站总访问量<span id="busuanzi_value_site_uv"></span>次



  <span class="post-meta-divider">|</span>







<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共99.8k字</span>
</div>

        







        
      </span></div>
    </div></footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script src="source/js/src/md5.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: '671a74b29bdf6595353a',
          clientSecret: '16404a140b737832473e48993cc3f5ac257621b2',
          repo: 'blanknesses.github.io',
          owner: 'Blanknesses',
          admin: ['Blanknesses'],
          id: location.pathname,
          distractionFreeMode: 'true'
        })
        gitalk.render('gitalk-container')
       </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

    <!-- 代码块复制功能 -->
    <script type="text/javascript" src="/js/src/clipboard.js"></script>
    <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>
